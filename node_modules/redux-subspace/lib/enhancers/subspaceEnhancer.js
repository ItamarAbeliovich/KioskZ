'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _applySubspaceMiddleware = require('./applySubspaceMiddleware');

var _applySubspaceMiddleware2 = _interopRequireDefault(_applySubspaceMiddleware);

var _namespacedAction = require('../actions/namespacedAction');

var _namespacedAction2 = _interopRequireDefault(_namespacedAction);

var _applyToChildren = require('../middleware/applyToChildren');

var _applyToChildren2 = _interopRequireDefault(_applyToChildren);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var verifyState = function verifyState(state) {
    if (process.env.NODE_ENV !== 'production') {
        console.assert(state !== undefined, 'mapState must not return undefined.');
    }
    return state;
}; /**
    * Copyright 2017, IOOF Holdings Limited.
    * All rights reserved.
    *
    * This source code is licensed under the BSD-style license found in the
    * LICENSE file in the root directory of this source tree.
    */

var subspaceEnhancer = function subspaceEnhancer(mapState, namespace) {
    return (0, _applySubspaceMiddleware2.default)((0, _applyToChildren2.default)(function (store) {
        return {
            getState: function getState(next) {
                return function () {
                    return verifyState(mapState(next(), store.rootStore.getState()));
                };
            },
            dispatch: function dispatch(next) {
                return function (action) {
                    return next((0, _namespacedAction2.default)(namespace)(action));
                };
            }
        };
    }));
};

exports.default = subspaceEnhancer;